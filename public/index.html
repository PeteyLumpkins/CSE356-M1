<html>
  <head>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <form onsubmit="getDocument(); return false;">
      Enter a document id: <input type="text" id="insertid" required="required">
      <!-- <input type="button" onclick="getDocument()" value="Submit"> -->
    </form>

    <p id="id"></p>
    <div id="quill"></div>

  </body>
  <script>
    let currID = undefined;
    let currText = undefined;
    setID(currID);
    setText(currText);

    // create web-event connection
    function getDocument(event) {
      let insertid = document.getElementById("insertid").value;
      if (setID(insertid)){
        currID = insertid;
        const events = new EventSource("http://localhost:3000/api/connect/" + currID);
        events.onmessage = (event) => {
          const parsedData = JSON.parse(event.data);
          currText = parsedData;
          setText(currText);
        };
      }
    }

    // Updates GUI
    function setID(id) {
      if (id !== undefined) {
        document.getElementById("id").innerText = "Document ID: " + id;
        return id !== currID;
      } else {
        document.getElementById("id").innerText = "Document ID: Undefined";
        return false;
      }
    }

    function setText(text) {
        document.getElementById("quill").innerText = text !== undefined ? text : "Insert ID to get document";
    }

    
  </script>
</html>
